([{HEADER:Î¼5_CodeWindow:ComponentDocumentation}])
UniversalDesktop Î¼2_CodeWindow Component Documentation
Î¼X-Bagua Integration: WIND (â˜´) Views/UI Pattern
Version: 2.1.0-raimund-algebra
Component Type: Î¼2_ (Views/UI) 
Location: src/components/windows/Î¼2_CodeWindow.tsx (537 LOC)

([{INPUT:Props:RequiredInputs}])
udItem: UDItem - VollstÃ¤ndiges UniversalDocument Item mit Code-Content
  â””â”€ udItem.content.code: string - Der Code-Content als String
  â””â”€ udItem.content.language: string - Programmiersprache ('typescript', 'python', etc.)
  â””â”€ udItem.content.theme: string - Theme ('light', 'dark')
  â””â”€ udItem.is_contextual: boolean - AI Context Manager Status
  â””â”€ udItem.transformation_history: array - Ã„nderungsprotokoll

onUDItemChange: function(updatedItem: UDItem, description: string) - Update Callback
  â””â”€ REQUIRED - Wird bei jeder Code-Ã„nderung aufgerufen
  â””â”€ ÃœbertrÃ¤gt vollstÃ¤ndiges UDItem mit Transformation History
  â””â”€ Description dokumentiert die Art der Ã„nderung

([{INPUT:Props:OptionalInputs}])
onAddToContext?: function(item: UDItem) - Context Manager Integration
  â””â”€ FÃ¼r ğŸ“Œ Button FunktionalitÃ¤t (AI Context hinzufÃ¼gen)
  â””â”€ Wird von Î¼6_ContextPanel bereitgestellt

readOnly?: boolean = false - Read-Only Modus fÃ¼r Code Review
autoFormat?: boolean = true - Automatische Code-Formatierung aktivieren

([{OUTPUT:Capabilities:MainFeatures}])
Multi-Language Code Editor mit 8 unterstÃ¼tzten Sprachen:
  â””â”€ TypeScript (ğŸ”· .ts, 2 spaces)
  â””â”€ JavaScript (ğŸŸ¨ .js, 2 spaces) 
  â””â”€ Python (ğŸ .py, 4 spaces)
  â””â”€ HTML (ğŸŸ§ .html, 2 spaces)
  â””â”€ CSS (ğŸ¨ .css, 2 spaces)
  â””â”€ JSON (ğŸ“‹ .json, 2 spaces)
  â””â”€ Markdown (ğŸ“ .md, 2 spaces)
  â””â”€ Plain Text (ğŸ“„ .txt, 2 spaces)

Line Numbers Display mit Scroll-Synchronisation
Real-time Code Statistics (Lines, Characters)
Language-specific Auto-Formatting (Ctrl+S, Ctrl+Shift+F)
Dual Theme System (Light/Dark mit TUI-Terminal Colors)
Context Manager Integration (ğŸ“Œ Button fÃ¼r AI-Context)

([{PROCESSING:StateManagement:InternalState}])
Î¼2_codeState: Code Content + Metadata State
  â””â”€ code: string - Aktueller Code Content
  â””â”€ language: string - GewÃ¤hlte Programmiersprache
  â””â”€ lineCount/charCount: number - Statistiken
  â””â”€ lastModified: timestamp - Letzte Ã„nderung
  â””â”€ hasErrors/isFormatted: boolean - Status Flags

Î¼5_theme: Theme State ('light', 'dark')
Î¼2_isContextual: boolean - Context Manager Pin Status
Î¼2_scrollTop: number - Scroll Position fÃ¼r Line Numbers Sync

([{PROCESSING:LanguageSupport:FormattingRules}])
Language-Specific Formatting Engine:
  â””â”€ Python: 4-space indentation, colon-based block detection
  â””â”€ TypeScript/JavaScript: 2-space indentation, brace-based blocks, semicolon insertion
  â””â”€ HTML: Tag-based indentation with self-closing tag detection
  â””â”€ CSS/JSON: Standard bracket-based formatting
  â””â”€ Markdown/Plain: Minimal formatting preservation

TabSize Detection: Automatisch basierend auf gewÃ¤hlter Sprache
Auto-Format Trigger: Ctrl+S oder Ctrl+Shift+F
Format-Algorithm: Sprach-spezifische Regex + Indentation Logic

([{INTEGRATION:SpawnSources:CreationPaths}])
Human Creation Paths:
  â””â”€ Î¼2_ToolPanel.tsx â†’ "Code Editor" Button â†’ Î¼1_WindowFactory â†’ Î¼8_DesktopItem â†’ Î¼2_CodeWindow
  â””â”€ User selects 'code' type from Tool Panel

AI Creation Paths:
  â””â”€ Î¼2_AIPanel.tsx â†’ AI Response Analysis â†’ Î¼1_WindowFactory.detectOptimalType() â†’ 'code' â†’ Î¼2_CodeWindow
  â””â”€ AI automatically chooses Code Window for programming content

Factory Registration:
  â””â”€ Î¼1_WindowFactory.tsx line 45: 'code' registry entry
  â””â”€ component: Î¼2_CodeWindow, defaultDimensions: 750x550

([{INTEGRATION:DataFlow:UpdateCycle}])
Content Update Flow:
User Edit â†’ Î¼6_updateCodeContent() â†’ UDItem Update â†’ onUDItemChange() â†’ 
Î¼8_DesktopItem.onUpdate() â†’ UniversalDesktopv2.handleItemUpdate() â†’ 
Î¼1_useWorkspace.Î¼1_transformItem() â†’ Auto-Save (2s debounced)

Language/Theme Change Flow:
Dropdown Change â†’ Î¼6_changeLanguage()/Î¼6_changeTheme() â†’ UDItem Content Update â†’ 
Persistent Storage in both content{} and metadata{} â†’ Reload-Safe Persistence

Context Manager Flow:
ğŸ“Œ Button â†’ Î¼7_toggleContextPin() â†’ Î¼6_useContextManager.addToContext() â†’ 
Î¼6_ContextPanel displays â†’ AI Prompt Enhancement

([{INTEGRATION:Rendering:DesktopItemBridge}])
Container Integration - Î¼8_DesktopItem.tsx lines 269-303:
  â””â”€ Type Detection: item.type === 'code' â†’ Î¼2_CodeWindow rendering
  â””â”€ Content Conversion: DesktopItemData â†’ UDItem transformation
  â””â”€ Robust Content Loading: Handles both object and string content
  â””â”€ Metadata Preservation: language/theme from content OR metadata fallback

Content Structure Handling:
  â””â”€ Legacy: item.content as string â†’ Converted to object with defaults
  â””â”€ Modern: item.content as {code, language, theme} â†’ Direct usage
  â””â”€ Fallback Chain: content.language â†’ metadata.language â†’ 'typescript'

([{DEPENDENCIES:SystemIntegration:RequiredModules}])
Core Dependencies:
  â””â”€ React Hooks: useState, useEffect, useRef, useCallback, useMemo
  â””â”€ UDItem: ../../core/universalDocument - Core document format
  â””â”€ UDFormat: ../../core/UDFormat - Bagua constants & algebraic transistor

Integration Points:
  â””â”€ Î¼1_WindowFactory - Factory registration for creation
  â””â”€ Î¼8_DesktopItem - Container component for spatial placement
  â””â”€ Î¼6_ContextManager - AI Context integration via onAddToContext
  â””â”€ Î¼1_useWorkspace - Auto-save and persistence system

([{DEPENDENCIES:Styling:ThemeSystem}])
Î¼5_baguaTheme Colors (SEE-Pattern):
Light Theme:
  â””â”€ borderColor: 'rgba(167, 139, 250, 0.3)' - Bagua purple accent
  â””â”€ backgroundColor: 'rgba(167, 139, 250, 0.02)' - Subtle purple tint
  â””â”€ textColor: '#1f2937' - Dark gray text
  â””â”€ accentColor: '#a78bfa' - Purple accent

Dark Theme (TUI-Inspired):
  â””â”€ borderColor: '#00aa00' - Classic terminal green
  â””â”€ backgroundColor: '#001100' - Dark green background
  â””â”€ textColor: '#00ff00' - Bright terminal green
  â””â”€ lineNumberBg: '#003300' - Darker green for line numbers

([{PERFORMANCE:Optimization:KeyFeatures}])
React Performance Patterns:
  â””â”€ useMemo fÃ¼r Î¼5_baguaTheme - Theme-Berechnungen gecacht
  â””â”€ useCallback fÃ¼r Event Handler - Render-Optimierung
  â””â”€ Line Numbers Memoization - Verhindert unnÃ¶tige Re-Renders
  â””â”€ Scroll Synchronization - Smooth line number tracking

State Management Efficiency:
  â””â”€ Separate Theme State - UnabhÃ¤ngig von Code State
  â””â”€ Debounced Updates - Auto-save integration (2s delay)
  â””â”€ Transformation History - Komplettes Change Tracking
  â””â”€ Content Object Preservation - VollstÃ¤ndige Persistierung

([{BAGUA:Classification:ArchitecturalAlignment}])
Î¼X-Bagua Integration - WIND (â˜´) Pattern:
  â””â”€ Î¼2_ Functions: UI State Management, Language Selection, Rendering
  â””â”€ Î¼5_ Properties: Theme Colors, Component Metadata, Configuration
  â””â”€ Î¼6_ Functions: Code Processing, Language Change, Format Operations
  â””â”€ Î¼7_ Events: Keyboard Shortcuts, Context Pin, Scroll Handling
  â””â”€ Î¼8_ Global: UDItem Updates, Transformation History, Data Flow

Campus-Model Compliance:
  â””â”€ Single Responsibility: Code editing and language-specific formatting only
  â””â”€ Hook Integration: Works with specialized Î¼X_ hooks system
  â””â”€ Algebraic Transistor: Math.pow(0, condition ? 0 : 1) fÃ¼r Conditional Logic
  â””â”€ Pure Component: No side effects auÃŸer UDItem updates

([{FUTURE:Enhancement:PlannedFeatures}])
Phase 2 Enhancements:
  â””â”€ Syntax Highlighting Engine - Visual code differentiation
  â””â”€ Code Intelligence - Auto-completion, error detection
  â””â”€ Multi-cursor Support - Professional editor features
  â””â”€ Plugin Architecture - Language-specific extensions

Integration Roadmap:
  â””â”€ Î¼6_AICodeAssistant - AI-powered code suggestions
  â””â”€ Î¼3_FileSystemIntegration - Direct file editing capability
  â””â”€ Î¼7_AdvancedShortcuts - Professional editor shortcuts
  â””â”€ Î¼4_ProjectManagement - Multi-file code project support

([{TESTING:Validation:QualityAssurance}])
Component Status: âœ… FULLY FUNCTIONAL
  â””â”€ Language/Theme persistence: âœ… FIXED (content object storage)
  â””â”€ Multi-language support: âœ… WORKING (8 languages)
  â””â”€ Auto-formatting: âœ… WORKING (language-specific rules)
  â””â”€ Context integration: âœ… WORKING (ğŸ“Œ button functional)
  â””â”€ Auto-save integration: âœ… WORKING (2s debounced)

Known Limitations:
  â””â”€ No syntax highlighting (plain text with monospace font)
  â””â”€ Basic formatting only (no advanced code intelligence)
  â””â”€ Single-file editing (no project-wide features)
  â””â”€ Limited error detection (no real-time syntax validation)

([{USAGE:Examples:CommonScenarios}])
Human Code Creation:
  1. User clicks "Code Editor" in Î¼2_ToolPanel
  2. Î¼1_WindowFactory creates Î¼2_CodeWindow with TypeScript defaults
  3. User selects language (Python) from dropdown
  4. User writes code with 4-space Python indentation
  5. Auto-format on Ctrl+S applies Python-specific formatting
  6. Content persists with language/theme in UDItem

AI Code Generation:
  1. User sends AI prompt: "Create a Python function for data processing"
  2. Î¼2_AIPanel detects code content in response
  3. Î¼1_WindowFactory.detectOptimalType() returns 'code'
  4. Î¼2_CodeWindow spawns with Python auto-detected
  5. AI response pre-formatted with correct indentation
  6. User can modify and format further

Context Manager Integration:
  1. User writes important code function
  2. Clicks ğŸ“Œ button to add to AI context
  3. Î¼6_ContextManager stores code for AI reference
  4. Subsequent AI queries include this code as context
  5. AI provides contextually aware suggestions

([{FOOTER:Metadata:DocumentInfo}])
Document Format: Î¼5_ (SEE-Pattern) - Properties/Metadata Documentation
Created: 2025-01-30 | UniversalDesktop v2.1.0-raimund-algebra
Î¼X-Bagua Compliant: âœ… | Context Utilization: 19% â†’ Optimized for efficiency
Author: AI Assistant with Î¼X-Bagua Architecture Knowledge
Purpose: Human & AI Understanding of Î¼2_CodeWindow Integration Points